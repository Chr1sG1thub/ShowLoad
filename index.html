<html>
  <head>
    <title>Show Load</title>
</head>
  <body style = "font-family: Arial; font-size: 24px;">
    <h2>Required Load</h2>
    <div id="loads">Loading...</div>
<script>
  
const originalString = "API_KEY:3bjz27ydq97vjwmrc7f8u12oo";
const base64Encoded = btoa(originalString);
const today = new Date();
const todayStr = today.toISOString().substring(0,10);
let ctltod = 0;
let atltod = 0;
  
fetch('https://intervals.icu/api/v1/athlete/0/wellness/'+todayStr, {
  headers: {
    "Authorization": `Basic ${base64Encoded}`,
       "Accept": "application/json"
  }
})
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok ' + response.statusText);
    }
    return response.json();  // or response.text() for plain text
  })
  .then(data => {
    console.log(data);
    ctltod = data.ctl;
    atltod = data.atl;
    const ctltom = ctltod * 0.976472;
    const atltom = atltod * 0.866878;
    const tsstod = (ctltod-atltod-0)/(0.133122-0.023528);
    const tsstom = (ctltom-atltom-0)/(0.133122-0.023528);
    const tsstod2 = (ctltod-atltod-(-10))/(0.133122-0.023528);
    const tsstom2 = (ctltom-atltom-(-10))/(0.133122-0.023528);
    
      const xLoads = document.getElementById("loads");
      console.log(xLoads);
//      xLoads.innerHTML =  'Hello World';
      xLoads.innerHTML =  `Today's fitness is ${ctltod} and fatigue is ${atltod}.<BR/><BR/>For a target form of 0 (Grey Zone) the required load is ${tsstod}. If you do nothing more today, tomorrow's required load will be ${tsstom}.<BR/><BR/>For a target form of -10 (Optimal) the required load is ${tsstod2}. If you do nothing more today, tomorrow's required load will be ${tsstom2}.`;
  })
  .catch(error => {
    console.error('There was a problem with the fetch operation:', error);
  });
</script>
  </body>
</html>
